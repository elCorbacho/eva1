# üìö Sistema de Gesti√≥n de Biblioteca - Spring Boot

> **Para desarrolladores que vienen de Laravel/PHP**

## üéØ ¬øQu√© es este proyecto?

Es un sistema de informaci√≥n para una biblioteca que permite:
- ‚úÖ Buscar libros por t√≠tulo o autor
- ‚úÖ Consultar disponibilidad de libros
- ‚úÖ Realizar pr√©stamos y devoluciones
- ‚úÖ Gestionar usuarios
- ‚úÖ Ver historial de pr√©stamos

---

## üîß Requisitos Previos

1. **Java 21** (equivalente a PHP 8.x)
2. **Maven** (equivalente a Composer)
3. **IDE**: IntelliJ IDEA, Eclipse o VS Code

### Verificar instalaci√≥n:
```bash
java -version    # Debe mostrar Java 21
./mvnw -v        # Maven wrapper incluido en el proyecto
```

---

## üöÄ C√≥mo Ejecutar el Proyecto

### 1Ô∏è‚É£ Clonar o abrir el proyecto
```bash
cd c:\Users\histo\OneDrive\Escritorio\eva1\eva1
```

### 2Ô∏è‚É£ Instalar dependencias (como `composer install`)
```bash
./mvnw clean install
```

### 3Ô∏è‚É£ Ejecutar la aplicaci√≥n (como `php artisan serve`)
```bash
./mvnw spring-boot:run
```

### 4Ô∏è‚É£ Abrir en el navegador
```
http://localhost:8080
```

---

## üìÇ Estructura del Proyecto (vs Laravel)

| Spring Boot | Laravel | Descripci√≥n |
|-------------|---------|-------------|
| `src/main/java/controllers/` | `app/Http/Controllers/` | Controladores |
| `src/main/java/models/` | `app/Models/` | Modelos (Entities) |
| `src/main/java/services/` | `app/Services/` | L√≥gica de negocio |
| `src/main/java/repositories/` | *Eloquent integrado* | Acceso a datos |
| `src/main/resources/templates/` | `resources/views/` | Vistas HTML |
| `src/main/resources/application.properties` | `.env` | Configuraci√≥n |
| `src/main/resources/data.sql` | `database/seeders/` | Datos iniciales |
| `pom.xml` | `composer.json` | Dependencias |

---

## üèóÔ∏è Arquitectura (Comparaci√≥n con Laravel)

### **En Laravel:**
```
Request ‚Üí Route ‚Üí Controller ‚Üí Model (Eloquent) ‚Üí View
```

### **En Spring Boot:**
```
Request ‚Üí Controller ‚Üí Service ‚Üí Repository ‚Üí Entity ‚Üí Database
                ‚Üì
              View
```

### ¬øPor qu√© m√°s capas?

| Capa | Laravel | Spring Boot | Raz√≥n |
|------|---------|-------------|-------|
| **Controller** | Maneja todo | Solo HTTP | Separaci√≥n de responsabilidades |
| **Service** | Opcional | **Obligatorio** | L√≥gica de negocio reutilizable |
| **Repository** | Eloquent lo hace | **Manual** | Control total sobre consultas |

**Ventaja**: Mejor para proyectos grandes y testing.

---

## üìã Modelos (Entities)

### Comparaci√≥n Laravel vs Spring Boot

#### **Laravel (Eloquent)**
```php
class Libro extends Model {
    protected $fillable = ['titulo', 'autor'];
    
    // M√©todos ya incluidos:
    // Libro::all(), find($id), where()->get()
}
```

#### **Spring Boot (JPA)**
```java
@Entity
@Table(name = "libros")
public class Libro {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    private String titulo;
    private String autor;
    
    // Getters y Setters obligatorios
}
```

**Diferencia clave**: En Laravel, Eloquent hace todo autom√°ticamente. En Spring Boot, necesitas definir todo expl√≠citamente.

---

## üóÑÔ∏è Repositories (vs Eloquent)

### **Laravel**
```php
// NO necesitas crear nada, Eloquent lo hace:
$libros = Libro::all();
$libro = Libro::find(1);
```

### **Spring Boot**
```java
// Debes crear una interfaz Repository:
@Repository
public interface LibroRepository extends JpaRepository<Libro, Long> {
    List<Libro> findByTituloContaining(String titulo);
    // Spring genera autom√°ticamente el SQL
}
```

**Ventaja**: M√©todos como `findByTituloContaining` se generan autom√°ticamente por convenci√≥n.

---

## üîß Services (L√≥gica de Negocio)

### **Laravel (Opcional)**
```php
// Puedes hacerlo directo en el Controller:
class LibroController {
    public function index() {
        return Libro::all();
    }
}
```

### **Spring Boot (Obligatorio)**
```java
// Debes crear un Service:
@Service
public class LibroService {
    @Autowired
    private LibroRepository libroRepository;
    
    public List<Libro> obtenerTodos() {
        return libroRepository.findAll();
    }
}
```

**Raz√≥n**: Separa la l√≥gica de negocio del controlador (mejor para testing).

---

## üéÆ Controladores

### **Web Controller (HTML)**
```java
@Controller
@RequestMapping("/libros")
public class LibroController {
    @Autowired
    private LibroService libroService;
    
    @GetMapping
    public String listarLibros(Model model) {
        model.addAttribute("libros", libroService.obtenerTodos());
        return "libros/lista"; // Retorna vista HTML
    }
}
```

### **REST Controller (JSON)**
```java
@RestController
@RequestMapping("/api/libros")
public class LibroRestController {
    @Autowired
    private LibroService libroService;
    
    @GetMapping
    public ResponseEntity<List<Libro>> listarLibros() {
        return ResponseEntity.ok(libroService.obtenerTodos());
        // Retorna JSON autom√°ticamente
    }
}
```

---

## üåê Rutas Disponibles

### **Rutas Web (HTML en navegador)**
```
http://localhost:8080/                      ‚Üí P√°gina de inicio
http://localhost:8080/libros                ‚Üí Lista de libros
http://localhost:8080/libros/1              ‚Üí Detalle del libro
http://localhost:8080/libros/disponibilidad/1 ‚Üí Consultar disponibilidad
http://localhost:8080/usuarios              ‚Üí Lista de usuarios
http://localhost:8080/usuarios/1            ‚Üí Perfil de usuario
http://localhost:8080/prestamos             ‚Üí Lista de pr√©stamos
http://localhost:8080/prestamos/usuario/1   ‚Üí Pr√©stamos de un usuario
```

### **Rutas API REST (JSON para Postman)**

#### üìö **Libros**
```
GET    /api/libros                    ‚Üí Listar todos
GET    /api/libros/1                  ‚Üí Ver uno
GET    /api/libros/buscar?termino=... ‚Üí Buscar
POST   /api/libros                    ‚Üí Crear
PUT    /api/libros/1                  ‚Üí Actualizar
DELETE /api/libros/1                  ‚Üí Eliminar
```

#### üë• **Usuarios**
```
GET    /api/usuarios                  ‚Üí Listar todos
GET    /api/usuarios/1                ‚Üí Ver uno
GET    /api/usuarios/email/{email}    ‚Üí Buscar por email
GET    /api/usuarios/rut/{rut}        ‚Üí Buscar por RUT
POST   /api/usuarios                  ‚Üí Crear
PUT    /api/usuarios/1                ‚Üí Actualizar
DELETE /api/usuarios/1                ‚Üí Eliminar
```

#### üìñ **Pr√©stamos**
```
GET    /api/prestamos                 ‚Üí Listar todos
GET    /api/prestamos/1               ‚Üí Ver uno
GET    /api/prestamos/usuario/1       ‚Üí De un usuario
POST   /api/prestamos/realizar        ‚Üí Realizar pr√©stamo
PUT    /api/prestamos/devolver/1      ‚Üí Devolver libro
```

---

## üß™ Ejemplos con Postman

### 1. Listar todos los libros
```
GET http://localhost:8080/api/libros
```

**Respuesta:**
```json
[
  {
    "id": 1,
    "titulo": "Cien a√±os de soledad",
    "autor": "Gabriel Garc√≠a M√°rquez",
    "isbn": "978-0307474728",
    "editorial": "Editorial Sudamericana",
    "fechaPublicacion": "1967-06-05",
    "categoria": "Ficci√≥n",
    "copiasTotales": 5,
    "copiasDisponibles": 3
  }
]
```

### 2. Crear un libro
```
POST http://localhost:8080/api/libros
Content-Type: application/json

{
  "titulo": "El Aleph",
  "autor": "Jorge Luis Borges",
  "isbn": "978-0142437889",
  "editorial": "Emec√©",
  "fechaPublicacion": "1949-06-01",
  "categoria": "Cuentos",
  "copiasTotales": 5,
  "copiasDisponibles": 5
}
```

### 3. Realizar un pr√©stamo
```
POST http://localhost:8080/api/prestamos/realizar
Content-Type: application/json

{
  "libroId": 5,
  "usuarioId": 2
}
```

### 4. Devolver un libro
```
PUT http://localhost:8080/api/prestamos/devolver/1
```

---

## üóÉÔ∏è Base de Datos

### **Configuraci√≥n (application.properties)**
```properties
# H2 Database (en memoria, como SQLite)
spring.datasource.url=jdbc:h2:mem:biblioteca
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# JPA/Hibernate (ORM como Eloquent)
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=true
```

### **Acceder a la consola H2 (como phpMyAdmin)**
```
http://localhost:8080/h2-console

JDBC URL: jdbc:h2:mem:biblioteca
User: sa
Password: (dejar vac√≠o)
```

### **Datos de prueba (data.sql)**
Se cargan autom√°ticamente al iniciar la aplicaci√≥n (como seeders en Laravel).

---

## üîÑ Comparaci√≥n de Operaciones

| Operaci√≥n | Laravel | Spring Boot |
|-----------|---------|-------------|
| Listar todos | `Libro::all()` | `libroRepository.findAll()` |
| Buscar por ID | `Libro::find(1)` | `libroRepository.findById(1)` |
| Crear | `Libro::create([...])` | `libroRepository.save(libro)` |
| Actualizar | `$libro->save()` | `libroRepository.save(libro)` |
| Eliminar | `$libro->delete()` | `libroRepository.deleteById(1)` |
| Buscar con filtro | `Libro::where('titulo', 'like', '%...')` | `findByTituloContaining(...)` |

---

## üé® Vistas (Thymeleaf vs Blade)

### **Laravel (Blade)**
```blade
@foreach($libros as $libro)
    <h2>{{ $libro->titulo }}</h2>
@endforeach
```

### **Spring Boot (Thymeleaf)**
```html
<div th:each="libro : ${libros}">
    <h2 th:text="${libro.titulo}"></h2>
</div>
```

**Similar pero con sintaxis diferente.**

---

## üõ†Ô∏è Comandos √ötiles

### **Compilar el proyecto**
```bash
./mvnw clean install
```

### **Ejecutar la aplicaci√≥n**
```bash
./mvnw spring-boot:run
```

### **Detener la aplicaci√≥n**
```
Ctrl + C
```

### **Ver logs en tiempo real**
Los logs aparecen en la consola donde ejecutaste `spring-boot:run`

---

## üì¶ Dependencias Importantes (pom.xml)

```xml
<!-- Spring Boot Web (como Laravel routing) -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>

<!-- Thymeleaf (como Blade) -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-thymeleaf</artifactId>
</dependency>

<!-- JPA/Hibernate (como Eloquent) -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-jpa</artifactId>
</dependency>

<!-- H2 Database (como SQLite) -->
<dependency>
    <groupId>com.h2database</groupId>
    <artifactId>h2</artifactId>
</dependency>
```

---

## üîç Diferencias Clave con Laravel

| Aspecto | Laravel | Spring Boot |
|---------|---------|-------------|
| **Lenguaje** | PHP | Java |
| **ORM** | Eloquent (autom√°tico) | JPA/Hibernate (manual) |
| **Rutas** | `routes/web.php` | Anotaciones `@GetMapping` |
| **Inyecci√≥n** | Autom√°tica | `@Autowired` |
| **Migraciones** | `php artisan migrate` | JPA genera tablas autom√°ticamente |
| **Seeders** | `php artisan db:seed` | `data.sql` |
| **Servidor** | `php artisan serve` | `./mvnw spring-boot:run` |
| **Puerto** | 8000 | 8080 |

---

## ‚ùì Preguntas Frecuentes

### **¬øPor qu√© tantas capas?**
En proyectos grandes, separar Controller ‚Üí Service ‚Üí Repository facilita el mantenimiento y testing.

### **¬øEs m√°s dif√≠cil que Laravel?**
M√°s verboso, pero m√°s estructurado para aplicaciones empresariales.

### **¬øD√≥nde est√°n las rutas?**
No hay archivo `routes/web.php`. Las rutas se definen con anotaciones en los controladores:
```java
@GetMapping("/libros")  // Equivale a Route::get('/libros', ...)
```

### **¬øC√≥mo reiniciar la BD?**
Al usar `create-drop`, la base de datos se reinicia cada vez que ejecutas la aplicaci√≥n.

---

## üìû Soporte

- **Documentaci√≥n Spring Boot**: https://spring.io/guides
- **Tutorial JPA**: https://spring.io/guides/gs/accessing-data-jpa/
- **Thymeleaf**: https://www.thymeleaf.org/documentation.html

---

## ‚úÖ Checklist Inicial

- [ ] Java 21 instalado
- [ ] Proyecto clonado/abierto
- [ ] Ejecutar `./mvnw clean install`
- [ ] Ejecutar `./mvnw spring-boot:run`
- [ ] Abrir http://localhost:8080
- [ ] Probar rutas con Postman
- [ ] Acceder a H2 Console

---

**üéâ ¬°Listo! Ya tienes tu sistema de biblioteca funcionando.**
